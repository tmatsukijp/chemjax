YUI.add("moodle-atto_chemjaxpv-button",function(Y,NAME){require(["jquery"],function($){var notationwindow,id_editor=$("textarea.form-control").attr("id"),preview_window='<button id="btn_example" class="btn btn-primary" style="display:block;margin:1rem 0 0 auto">'+notation+'</button><div id="preview_window" class="border-primary" style="border:2px solid red; min-height:200px; margin-top:0"></div>',$preview=$('<div id="preview">'+preview_window+"</div>");function makePreview(){input=$("#"+id_editor).val(),$("#preview_window").html(input),MathJax.Hub.Queue(["Typeset",MathJax.Hub,"preview_window"])}$("button.atto_chemjaxpv_button").each(function(i){0<i&&$(this).hide()}),$("#"+id_editor).after($preview),$("#preview").hide(),$("#btn_example").on("click",function(e){e.preventDefault();var param=ctxid;return this.href=notationurl+param,notationwindow&&!notationwindow.closed||(notationwindow="newtab"==displaytype?window.open(this.href,"chamjaxnotation"):window.open(this.href,"chemjaxnotation","width=600,height=500,resizable=yes,scrollbars=yes")),!1}),$(".atto_chemjaxpv_button").on("click",function(){$(this).toggleClass("highlight"),$("#preview").toggle(),makePreview(),!notationwindow&&notationwindow.closed||notationwindow.close()}),$("body").on("keyup change","#"+id_editor,function(){makePreview()})});Y.namespace("M.atto_chemjaxpv").Button=Y.Base.create("button",Y.M.editor_atto.EditorPlugin,[],{initializer:function(){this.addButton({icon:"chemjax",iconComponent:"atto_chemjaxpv",callback:this._getContext}).set("title",M.util.get_string("pluginname","atto_chemjaxpv")),notation=M.util.get_string("notation","atto_chemjaxpv"),displaytype=this.get("displaytype"),ctxid="?contextid="+this.get("contextid"),notationurl=this.get("notationurl")}},{ATTRS:{notationurl:{value:null},contextid:{value:null},displaytype:{value:null}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});